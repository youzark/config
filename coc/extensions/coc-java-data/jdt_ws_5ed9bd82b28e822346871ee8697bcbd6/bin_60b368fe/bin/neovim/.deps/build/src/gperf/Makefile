# Makefile for gperf

# Copyright (C) 1989, 1992, 1993, 1998, 2002, 2012, 2016 Free Software Foundation, Inc.
# Written by Douglas C. Schmidt <schmidt@ics.uci.edu>
# and Bruno Haible <bruno@clisp.org>.
#
# This file is part of GNU GPERF.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

#### Start of system configuration section. ####

# Programs used by "make":
RM = rm -f


#### End of system configuration section. ####

SHELL = /bin/sh

all : force
	cd lib; $(MAKE) all
	cd src; $(MAKE) all
	cd tests; $(MAKE) all
	cd doc; $(MAKE) all

install : force
	cd lib; $(MAKE) install
	cd src; $(MAKE) install
	cd tests; $(MAKE) install
	cd doc; $(MAKE) install

installdirs : force
	cd lib; $(MAKE) installdirs
	cd src; $(MAKE) installdirs
	cd tests; $(MAKE) installdirs
	cd doc; $(MAKE) installdirs

uninstall : force
	cd lib; $(MAKE) uninstall
	cd src; $(MAKE) uninstall
	cd tests; $(MAKE) uninstall
	cd doc; $(MAKE) uninstall

check : force
	cd lib; $(MAKE) check
	cd src; $(MAKE) check
	cd tests; $(MAKE) check
	cd doc; $(MAKE) check

mostlyclean : force
	cd lib; $(MAKE) mostlyclean
	cd src; $(MAKE) mostlyclean
	cd tests; $(MAKE) mostlyclean
	cd doc; $(MAKE) mostlyclean

clean : force
	cd lib; $(MAKE) clean
	cd src; $(MAKE) clean
	cd tests; $(MAKE) clean
	cd doc; $(MAKE) clean

distclean : force
	cd lib; if test -f Makefile; then $(MAKE) distclean; fi
	cd src; if test -f Makefile; then $(MAKE) distclean; fi
	cd tests; if test -f Makefile; then $(MAKE) distclean; fi
	cd doc; if test -f Makefile; then $(MAKE) distclean; fi
	$(RM) config.status config.log config.cache Makefile

maintainer-clean : force
	cd lib; if test -f Makefile; then $(MAKE) maintainer-clean; fi
	cd src; if test -f Makefile; then $(MAKE) maintainer-clean; fi
	cd tests; if test -f Makefile; then $(MAKE) maintainer-clean; fi
	cd doc; if test -f Makefile; then $(MAKE) maintainer-clean; fi
	$(RM) config.status config.log config.cache Makefile

# List of source files.
SOURCE_FILES = \
  README README.windows README.vms NEWS AUTHORS \
  configure.ac aclocal.m4 Makefile.in Makefile.vms \
  Makefile.devel ChangeLog
# List of distributed files imported from other packages.
IMPORTED_FILES = \
  COPYING INSTALL \
  build-aux/install-sh build-aux/mkinstalldirs \
  build-aux/compile build-aux/ar-lib
# List of distributed files generated by autotools or Makefile.devel.
GENERATED_FILES = configure
# List of distributed files generated by "make".
DISTRIBUTED_BUILT_FILES =
# List of distributed files.
DISTFILES = $(SOURCE_FILES) $(IMPORTED_FILES) $(GENERATED_FILES) $(DISTRIBUTED_BUILT_FILES)

distdir : $(DISTFILES)
	for file in $(DISTFILES); do \
	  if test -f $$file; then dir='.'; else dir='$(srcdir)'; fi; \
	  destdir=`echo '$(distdir)'/$$file | sed -e 's|//*[^/]*$$||'`; \
	  test -d "$$destdir" || mkdir "$$destdir"; \
	  cp -p $$dir/$$file '$(distdir)'/$$file || exit 1; \
	done
	subdir=lib; test -d '$(distdir)'/$$subdir || mkdir '$(distdir)'/$$subdir; cd $$subdir; $(MAKE) distdir distdir='$(distdir)'/$$subdir
	subdir=src; test -d '$(distdir)'/$$subdir || mkdir '$(distdir)'/$$subdir; cd $$subdir; $(MAKE) distdir distdir='$(distdir)'/$$subdir
	subdir=tests; test -d '$(distdir)'/$$subdir || mkdir '$(distdir)'/$$subdir; cd $$subdir; $(MAKE) distdir distdir='$(distdir)'/$$subdir
	subdir=doc; test -d '$(distdir)'/$$subdir || mkdir '$(distdir)'/$$subdir; cd $$subdir; $(MAKE) distdir distdir='$(distdir)'/$$subdir

# Creating a distribution tarball.
PACKAGE = gperf
VERSION = `sed -n -e 's/.*version_string = "\(.*\)".*/\1/p' < src/version.cc`
TAR = tar
GZIP = gzip

dist : force
	tmpdistdir=$(PACKAGE)-$(VERSION); \
	abstmpdistdir=`pwd`/$$tmpdistdir; \
	rm -rf $$tmpdistdir $$tmpdistdir.tar $$tmpdistdir.tar.gz \
	  && mkdir $$tmpdistdir \
	  && $(MAKE) distdir distdir="$$abstmpdistdir" \
	  && $(TAR) chof $$tmpdistdir.tar --owner=root --group=root $$tmpdistdir \
	  && $(GZIP) -9 $$tmpdistdir.tar \
	  && rm -rf $$tmpdistdir

force :

